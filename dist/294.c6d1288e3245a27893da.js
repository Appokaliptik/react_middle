"use strict";(self.webpackChunkreact_middle=self.webpackChunkreact_middle||[]).push([[294],{9284:(e,t,a)=>{a.r(t),a.d(t,{default:()=>B});var r=a(2445),n=a(7294),s=a(1072),i=a(4187),c=a(9457),l=a(1715),o=a(6628).p.injectEndpoints({endpoints:function(e){return{getArticleRecommendationsList:e.query({query:function(e){return{url:"/articles",params:{_limit:e}}}})}}}).useGetArticleRecommendationsListQuery,d=a(5893),u=(0,n.memo)((function(e){var t=e.className,a=(0,s.$G)("articles_details").t,n=o(4),u=n.isLoading,m=n.error,x=n.data;return u||m||!x?null:(0,d.jsxs)(c.g,{gap:"8",className:(0,i.A)("",{},[t]),children:[(0,d.jsx)(l.xv,{size:l.yH.L,title:a("Recommended")}),(0,d.jsx)(r.wD,{articles:x,target:"_blank"})]})})),m=a(7779),x=a(5754),h=a(4268),f=a(5861),g=a(4687),v=a.n(g),p=(0,h.hg)("articleDetails/fetchCommentsByArticleId",function(){var e=(0,f.Z)(v().mark((function e(t,a){var r,n,s;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.extra,n=a.rejectWithValue,t){e.next=3;break}return e.abrupt("return",n("error"));case 3:return e.prev=3,e.next=6,r.api.get("/comments/",{params:{articleId:t,_expand:"user"}});case 6:if((s=e.sent).data){e.next=9;break}throw new Error;case 9:return e.abrupt("return",s.data);case 12:return e.prev=12,e.t0=e.catch(3),e.abrupt("return",n("error"));case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,a){return e.apply(this,arguments)}}()),j=(0,h.HF)({selectId:function(e){return e.id}}),N=j.getSelectors((function(e){var t;return(null===(t=e.ArticleDetailsPages)||void 0===t?void 0:t.comments)||j.getInitialState()})),b=(0,h.oM)({name:"articleDetailsComments",initialState:j.getInitialState({error:void 0,isLoading:!1,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(p.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(p.fulfilled,(function(e,t){e.isLoading=!1,j.setAll(e,t.payload)})).addCase(p.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer,C=(0,m.UY)({recommendations:x.r,comments:b}),A=a(6974),L=a(8205),k=a(4876),w=a(2222),_=a(5321),y=(0,w.P1)(r.wq,_.m5,(function(e,t){return!(!e||!t)&&e.user.id===t.id})),D=a(3942),I=a(9372),S=a(5255),q=(0,n.memo)((function(e){var t=e.className,a=(0,s.$G)("articles_details").t,l=(0,A.s0)(),o=(0,D.v9)(y),u=(0,D.v9)(r.wq),m=(0,n.useCallback)((function(){l(I.h.articles)}),[l]),x=(0,n.useCallback)((function(){l("".concat(I.h.article_details).concat(null==u?void 0:u.id,"/edit"))}),[null==u?void 0:u.id,l]);return(0,d.jsxs)(c.U,{justify:"between",max:!0,className:(0,i.A)("",{},[t]),children:[(0,d.jsx)(S.zx,{theme:S.Wu.OUTLINE,onClick:m,children:a("back to list")}),o&&(0,d.jsx)(S.zx,{theme:S.Wu.OUTLINE,onClick:x,children:a("Edit")})]})}));const z="adu8f";var E=a(3312),G=a(2949),O=a(6897);const U={CommentCard:"D_1ld",header:"MKn3Z",username:"hXMDF",loading:"SrYg_"};var T=(0,n.memo)((function(e){var t=e.className,a=e.comments;return e.isLoading?(0,d.jsxs)("div",{className:(0,i.A)(U.CommentCard,{},[t,U.loading]),children:[(0,d.jsxs)("div",{className:U.header,children:[(0,d.jsx)(E.O,{width:30,height:30,border:"50%",className:U.avatar}),(0,d.jsx)(E.O,{height:16,width:100})]}),(0,d.jsx)(E.O,{className:U.text,width:"100%",height:50})]}):a?(0,d.jsxs)(c.g,{gap:"8",max:!0,className:(0,i.A)(U.CommentCard,{},[t]),children:[(0,d.jsxs)(O.F,{to:"".concat(I.h.profile).concat(a.user.id),className:U.header,children:[a.user.avatar?(0,d.jsx)(G.q,{size:30,src:a.user.avatar,className:U.avatar}):null,(0,d.jsx)(l.xv,{title:a.user.username})]}),(0,d.jsx)(l.xv,{className:U.text,text:a.text})]}):null})),W=(0,n.memo)((function(e){var t=e.className,a=e.isLoading,r=e.comments,n=(0,s.$G)("articles_details").t;return a?(0,d.jsxs)(c.g,{gap:"16",max:!0,className:(0,i.A)("",{},[t]),children:[(0,d.jsx)(T,{isLoading:!0}),(0,d.jsx)(T,{isLoading:!0}),(0,d.jsx)(T,{isLoading:!0})]}):(0,d.jsx)(c.g,{gap:"16",max:!0,className:(0,i.A)("",{},[t]),children:null!=r&&r.length?r.map((function(e){return(0,d.jsx)(T,{isLoading:a,comments:e},e.id)})):(0,d.jsx)(l.xv,{text:n("no comments")})})})),$=(0,n.lazy)((function(){return a.e(62).then(a.bind(a,2062))})),F=a(9169),P=a(9728),R=a(3212),H=function(e){var t;return(null===(t=e.ArticleDetailsPages)||void 0===t?void 0:t.comments.isLoading)||!1},M=a(3860),Z=(0,h.hg)("articleDetails/addCommentForArticle",function(){var e=(0,f.Z)(v().mark((function e(t,a){var r,n,s,i,c,l,o;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.extra,n=a.rejectWithValue,s=a.getState,i=a.dispatch,c=(0,_.m5)(s()),l=(0,M.wq)(s()),t&&c&&l){e.next=5;break}return e.abrupt("return",n("no data"));case 5:return e.prev=5,e.next=8,r.api.post("/comments",{articleId:l.id,text:t,userId:c.id});case 8:if((o=e.sent).data){e.next=11;break}throw new Error("No data");case 11:return i(p(l.id)),e.abrupt("return",o.data);case 15:return e.prev=15,e.t0=e.catch(5),console.log(e.t0),e.abrupt("return",n("error"));case 19:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,a){return e.apply(this,arguments)}}()),Q=(0,n.memo)((function(e){var t=e.className,a=e.id,r=(0,s.$G)("articles_details").t,o=(0,F.T)(),u=(0,D.v9)(H),m=(0,D.v9)(N.selectAll);(0,P.Q)((function(){o(p(a))}));var x=(0,n.useCallback)((function(e){o(Z(e))}),[o]);return(0,d.jsxs)(c.g,{gap:"16",max:!0,className:(0,i.A)("",{},[t]),children:[(0,d.jsx)(l.xv,{size:l.yH.L,title:r("Comment title")}),(0,d.jsx)(n.Suspense,{fallback:(0,d.jsx)(R.a,{}),children:(0,d.jsx)($,{onSendComment:x})}),(0,d.jsx)(W,{comments:m,isLoading:u})]})})),V={ArticleDetailsPages:C},Y=function(e){var t=e.className,a=(0,s.$G)("articles_details").t,n=(0,A.UO)().id;return n?(0,d.jsx)(L.W,{reducers:V,removeAfterUnmount:!0,children:(0,d.jsx)(k.T,{className:(0,i.A)(z,{},[t]),children:(0,d.jsxs)(c.g,{gap:"16",max:!0,children:[(0,d.jsx)(q,{}),(0,d.jsx)(r.D0,{id:n||"1"}),(0,d.jsx)(u,{}),(0,d.jsx)(Q,{id:n})]})})}):(0,d.jsx)(k.T,{className:(0,i.A)(z,{},[t]),children:a("articles not found")})};const B=(0,n.memo)(Y)}}]);