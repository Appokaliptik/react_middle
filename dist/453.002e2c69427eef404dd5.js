"use strict";(self.webpackChunkreact_middle=self.webpackChunkreact_middle||[]).push([[453],{6453:(e,r,n)=>{n.r(r),n.d(r,{default:()=>X});var a=n(4942),t=n(1072),o=n(7294),i=n(1715),l=n(3942),c=function(e){return e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazahstan",e.Armenia="Armenia",e}({}),u=n(4187),s=n(7736),d=n(5893),f=[{value:c.Armenia,content:c.Armenia},{value:c.Belarus,content:c.Belarus},{value:c.Kazakhstan,content:c.Kazakhstan},{value:c.Russia,content:c.Russia},{value:c.Ukraine,content:c.Ukraine}],p=(0,o.memo)((function(e){var r=e.className,n=e.value,a=e.onChange,i=e.readonly,l=e.direction,c=(0,t.$G)("translation").t,p=(0,o.useCallback)((function(e){null==a||a(e)}),[a]);return(0,d.jsx)(s.wb,{className:(0,u.A)("",{},[r]),value:n,label:c("Country"),onChange:p,items:f,readonly:i,direction:l})})),v=function(e){return e.RUB="RUB",e.EUR="EUR",e.USD="USD",e}({}),g=[{value:v.EUR,content:v.EUR},{value:v.RUB,content:v.RUB},{value:v.USD,content:v.USD}],h=(0,o.memo)((function(e){var r=e.className,n=e.value,a=e.onChange,i=e.readonly,l=e.direction,c=(0,t.$G)("translation").t,f=(0,o.useCallback)((function(e){null==a||a(e)}),[a]);return(0,d.jsx)(s.wb,{className:(0,u.A)("",{},[r]),value:n,label:c("currency"),onChange:f,items:g,readonly:i,direction:l})})),C=n(2949),m=n(8312),y=n(3212),R=n(9457);const j={ProfileCard:"wW9jg",editForm:"U9LGH",loading:"t07Zx",error:"i5YK3",avatarWrapper:"bEFNS"};var x=function(e){var r=e.className,n=e.data,o=e.isLoading,l=e.error,c=e.readonly,s=e.onChangeFirst,f=e.onChangeLastname,v=e.onChangeAge,g=e.onChangeCity,x=e.onChangeUsername,O=e.onChangeAvatar,E=e.onChangeCountry,b=e.onChangeCurrency,N=(0,t.$G)("profile").t,A=(0,a.Z)({},j.editForm,!c);return o?(0,d.jsx)(R.g,{max:!0,justify:"center",align:"center",className:(0,u.A)(j.ProfileCard,{},[r,j.loading]),children:(0,d.jsx)(y.a,{})}):l?(0,d.jsx)(R.g,{max:!0,className:(0,u.A)(j.ProfileCard,{},[r,j.error]),children:(0,d.jsx)(i.xv,{theme:i.lg.ERROR,title:N("profile error"),text:N("profile error text"),align:i.PH.CENTER})}):(0,d.jsxs)(R.g,{gap:"16",max:!0,className:(0,u.A)(j.ProfileCard,A,[r]),children:[(null==n?void 0:n.avatar)&&(0,d.jsx)(R.U,{justify:"center",className:j.avatarWrapper,children:(0,d.jsx)(C.q,{src:n.avatar})}),(0,d.jsx)(m.I,{value:null==n?void 0:n.first,placeholder:N("input firstname"),readonly:c,onChange:s}),(0,d.jsx)(m.I,{className:j.input,value:null==n?void 0:n.lastname,placeholder:N("input lastname"),readonly:c,onChange:f}),(0,d.jsx)(m.I,{className:j.input,value:null==n?void 0:n.age,placeholder:N("input age"),readonly:c,onChange:v}),(0,d.jsx)(m.I,{className:j.input,value:null==n?void 0:n.city,placeholder:N("input city"),readonly:c,onChange:g}),(0,d.jsx)(m.I,{className:j.input,value:null==n?void 0:n.username,placeholder:N("input username"),readonly:c,onChange:x}),(0,d.jsx)(m.I,{className:j.input,value:null==n?void 0:n.avatar,placeholder:N("input avatar"),readonly:c,onChange:O}),(0,d.jsx)(p,{className:j.input,value:null==n?void 0:n.country,readonly:c,onChange:E,direction:"top right"}),(0,d.jsx)(h,{className:j.input,value:null==n?void 0:n.currency,readonly:c,onChange:b,direction:"top right"})]})},O=n(9169),E=n(9728),b=n(8205),N=function(e){return e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_CITY="INCORRECT_CITY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR",e}({}),A=n(5861),k=n(4687),T=n.n(k),P=n(4268),U=(0,P.hg)("profile/fetchProfileData",function(){var e=(0,A.Z)(T().mark((function e(r,n){var a,t,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.extra,t=n.rejectWithValue,e.prev=1,e.next=4,a.api.get("/profile/".concat(r));case 4:if((o=e.sent).data){e.next=7;break}throw new Error;case 7:return e.abrupt("return",o.data);case 10:return e.prev=10,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",t("error"));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(r,n){return e.apply(this,arguments)}}()),I=function(e){var r;return null===(r=e.profile)||void 0===r?void 0:r.error},_=function(e){var r;return null===(r=e.profile)||void 0===r?void 0:r.form},w=function(e){var r;return null===(r=e.profile)||void 0===r?void 0:r.isLoading},D=function(e){var r;return null===(r=e.profile)||void 0===r?void 0:r.readonly},S=function(e){var r;return null===(r=e.profile)||void 0===r?void 0:r.validateErrors},L=function(e){if(!e)return[N.NO_DATA];var r=e.first,n=e.lastname,a=e.age,t=e.city,o=[];return r&&n||o.push(N.INCORRECT_USER_DATA),(!a||a<18||a>100)&&o.push(N.INCORRECT_AGE),t||o.push(N.INCORRECT_CITY),o},Z=(0,P.hg)("profile/updateProfileData",function(){var e=(0,A.Z)(T().mark((function e(r,n){var a,t,o,i,l,c;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.extra,t=n.rejectWithValue,o=n.getState,i=_(o()),!(l=L(i)).length){e.next=5;break}return e.abrupt("return",t(l));case 5:return e.prev=5,e.next=8,a.api.put("/profile/".concat(null==i?void 0:i.id),i);case 8:if((c=e.sent).data){e.next=11;break}throw new Error;case 11:return e.abrupt("return",c.data);case 14:return e.prev=14,e.t0=e.catch(5),console.log(e.t0),e.abrupt("return",t([N.SERVER_ERROR]));case 18:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(r,n){return e.apply(this,arguments)}}());function G(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?G(Object(n),!0).forEach((function(r){(0,a.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var B=(0,P.oM)({name:"profile",initialState:{data:void 0,isLoading:!1,readonly:!0,error:void 0},reducers:{setReadonly:function(e,r){e.readonly=r.payload},cancelEdit:function(e){e.readonly=!0,e.form=e.data,e.validateErrors=void 0},updateProfile:function(e,r){e.form=W(W({},e.form),r.payload)}},extraReducers:function(e){e.addCase(U.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(U.fulfilled,(function(e,r){e.isLoading=!1,e.data=r.payload,e.form=r.payload})).addCase(U.rejected,(function(e,r){e.isLoading=!1,e.error=r.payload})).addCase(Z.pending,(function(e){e.validateErrors=void 0,e.isLoading=!0})).addCase(Z.fulfilled,(function(e,r){e.isLoading=!1,e.data=r.payload,e.form=r.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(Z.rejected,(function(e,r){e.isLoading=!1,e.validateErrors=r.payload}))}}),z=B.actions,F=B.reducer,V=n(5321),Y=n(5255),$=function(e){var r;return null===(r=e.profile)||void 0===r?void 0:r.data},K=function(e){e.className;var r=(0,t.$G)("profile").t,n=(0,l.v9)($),a=(0,l.v9)(V.m5),c=(null==n?void 0:n.id)===(null==a?void 0:a.id),u=(0,l.v9)(D),s=(0,O.T)(),f=(0,o.useCallback)((function(){s(z.setReadonly(!1))}),[s]),p=(0,o.useCallback)((function(){s(z.cancelEdit())}),[s]),v=(0,o.useCallback)((function(){s(Z())}),[s]);return(0,d.jsxs)(R.U,{justify:"between",max:!0,children:[(0,d.jsx)(i.xv,{title:r("profile page")}),c&&(0,d.jsx)(R.U,{children:u?(0,d.jsx)(Y.zx,{theme:Y.Wu.OUTLINE,onClick:f,children:r("edit")}):(0,d.jsxs)(R.U,{gap:"8",children:[(0,d.jsx)(Y.zx,{theme:Y.Wu.OUTLINE,onClick:v,children:r("Save")}),(0,d.jsx)(Y.zx,{theme:Y.Wu.OUTLINE_RED,onClick:p,children:r("Cancel")})]})})]})},M={profile:F},H=(0,o.memo)((function(e){var r,n=e.className,c=e.id,s=(0,t.$G)("profile").t,f=(0,O.T)(),p=(0,l.v9)(_),v=(0,l.v9)(w),g=(0,l.v9)(I),h=(0,l.v9)(D),C=(0,l.v9)(S);(0,E.Q)((function(){c&&f(U(c))}));var m=(r={},(0,a.Z)(r,N.INCORRECT_AGE,s("incorrect age")),(0,a.Z)(r,N.INCORRECT_CITY,s("incorrect  city")),(0,a.Z)(r,N.INCORRECT_USER_DATA,s("incorrect user data")),(0,a.Z)(r,N.NO_DATA,s("incorrect data")),(0,a.Z)(r,N.SERVER_ERROR,s("incorrect server error")),r),y=(0,o.useCallback)((function(e){f(z.updateProfile({first:e||""}))}),[f]),j=(0,o.useCallback)((function(e){f(z.updateProfile({lastname:e||""}))}),[f]),A=(0,o.useCallback)((function(e){f(z.updateProfile({age:Number((null==e?void 0:e.replace(/\D/gi,""))||0)}))}),[f]),k=(0,o.useCallback)((function(e){f(z.updateProfile({city:e||""}))}),[f]),T=(0,o.useCallback)((function(e){f(z.updateProfile({username:e||""}))}),[f]),P=(0,o.useCallback)((function(e){f(z.updateProfile({avatar:e||""}))}),[f]),L=(0,o.useCallback)((function(e){f(z.updateProfile({currency:e}))}),[f]),Z=(0,o.useCallback)((function(e){f(z.updateProfile({country:e}))}),[f]);return(0,d.jsx)(b.W,{reducers:M,children:(0,d.jsxs)(R.g,{gap:"16",max:!0,className:(0,u.A)("",{},[n]),children:[(0,d.jsx)(K,{}),(null==C?void 0:C.length)&&C.map((function(e){return(0,d.jsx)(i.xv,{theme:i.lg.ERROR,text:m[e]},e)})),(0,d.jsx)(x,{data:p,isLoading:v,error:g,readonly:h,onChangeFirst:y,onChangeLastname:j,onChangeAge:A,onChangeCity:k,onChangeUsername:T,onChangeAvatar:P,onChangeCurrency:L,onChangeCountry:Z})]})})})),q=n(6974),Q=n(4876);const X=function(e){var r=e.className,n=(0,t.$G)("profile").t,a=(0,q.UO)().id;return a?(0,d.jsx)(Q.T,{className:(0,u.A)("",{},[r]),children:(0,d.jsx)(R.g,{gap:"16",children:(0,d.jsx)(H,{id:a})})}):(0,d.jsx)(i.xv,{text:n("profile not found")})}},8205:(e,r,n)=>{n.d(r,{W:()=>l});var a=n(9439),t=n(7294),o=n(3942),i=n(5893),l=function(e){var r=e.children,n=e.reducers,l=e.removeAfterUnmount,c=void 0===l||l,u=(0,o.oR)(),s=(0,o.I0)();return(0,t.useEffect)((function(){var e=u.reducerManager.getReducerMap();return Object.entries(n).forEach((function(r){var n=(0,a.Z)(r,2),t=n[0],o=n[1];e[t]||(u.reducerManager.add(t,o),s({type:"@INIT ".concat(t," reducer")}))})),function(){c&&Object.entries(n).forEach((function(e){var r=(0,a.Z)(e,2),n=r[0];r[1],u.reducerManager.remove(n),s({type:"@DESTROY ".concat(n," reducer")})}))}}),[]),(0,i.jsx)(i.Fragment,{children:r})}},8312:(e,r,n)=>{n.d(r,{I:()=>f});var a=n(4942),t=n(4925),o=n(4187),i=n(7294);var l=n(9457),c=n(5893),u=["className","value","onChange","type","placeholder","readonly"];function s(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?s(Object(n),!0).forEach((function(r){(0,a.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var f=(0,i.memo)((function(e){var r=e.className,n=e.value,i=void 0===n?"":n,s=e.onChange,f=e.type,p=void 0===f?"text":f,v=e.placeholder,g=e.readonly,h=(0,t.Z)(e,u),C=(0,a.Z)({},"fTN1P",g);return(0,c.jsxs)(l.g,{gap:"4",max:!0,className:(0,o.A)("LuFDU",C,[r]),children:[(0,c.jsx)("div",{children:v}),(0,c.jsx)("input",d({type:p,onChange:function(e){null==s||s(e.target.value)},className:"X8EVb",placeholder:v,value:i,readOnly:g},h))]})}))}}]);