"use strict";(self.webpackChunkreact_middle=self.webpackChunkreact_middle||[]).push([[453],{11:(e,a,r)=>{r.d(a,{I:()=>s});var n=r(7294),t=r(4187);var l=r(9457),o=r(5893);const s=(0,n.memo)((e=>{const{className:a,value:r="",onChange:n,type:s="text",placeholder:i,readonly:c,...d}=e,u={fTN1P:c};return(0,o.jsxs)(l.g,{gap:"4",max:!0,className:(0,t.A)("LuFDU",u,[a]),children:[(0,o.jsx)("div",{children:i}),(0,o.jsx)("input",{type:s,onChange:e=>{n?.(e.target.value)},className:"X8EVb",placeholder:i,value:r,readOnly:c,...d})]})}))},6453:(e,a,r)=>{r.r(a),r.d(a,{default:()=>K});var n=r(9887),t=r(6974);let l=function(e){return e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_CITY="INCORRECT_CITY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR",e}({});var o=r(7294),s=r(3942),i=r(8699);let c=function(e){return e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazahstan",e.Armenia="Armenia",e}({});var d=r(4187),u=r(9607),C=r(5893);const p=[{value:c.Armenia,content:c.Armenia},{value:c.Belarus,content:c.Belarus},{value:c.Kazakhstan,content:c.Kazakhstan},{value:c.Russia,content:c.Russia},{value:c.Ukraine,content:c.Ukraine}],h=(0,o.memo)((e=>{const{className:a,value:r,onChange:t,readonly:l,direction:s}=e,{t:i}=(0,n.$G)("translation"),c=(0,o.useCallback)((e=>{t?.(e)}),[t]);return(0,C.jsx)(u.wb,{className:(0,d.A)("",{},[a]),value:r,label:i("Country"),onChange:c,items:p,readonly:l,direction:s})}));let g=function(e){return e.RUB="RUB",e.EUR="EUR",e.USD="USD",e}({});const m=[{value:g.EUR,content:g.EUR},{value:g.RUB,content:g.RUB},{value:g.USD,content:g.USD}],R=(0,o.memo)((e=>{const{className:a,value:r,onChange:t,readonly:l,direction:s}=e,{t:i}=(0,n.$G)("translation"),c=(0,o.useCallback)((e=>{t?.(e)}),[t]);return(0,C.jsx)(u.wb,{className:(0,d.A)("",{},[a]),value:r,label:i("currency"),onChange:c,items:m,readonly:l,direction:s})}));var v=r(6794),f=r(11),x=r(5769),y=r(9457);const E={ProfileCard:"wW9jg",editForm:"U9LGH",loading:"t07Zx",error:"i5YK3",avatarWrapper:"bEFNS"},N=e=>{const{className:a,data:r,isLoading:t,error:l,readonly:o,onChangeFirst:s,onChangeLastname:c,onChangeAge:u,onChangeCity:p,onChangeUsername:g,onChangeAvatar:m,onChangeCountry:N,onChangeCurrency:j}=e,{t:A}=(0,n.$G)("profile"),T={[E.editForm]:!o};return t?(0,C.jsx)(y.g,{max:!0,justify:"center",align:"center",className:(0,d.A)(E.ProfileCard,{},[a,E.loading]),children:(0,C.jsx)(x.a,{})}):l?(0,C.jsx)(y.g,{max:!0,className:(0,d.A)(E.ProfileCard,{},[a,E.error]),children:(0,C.jsx)(i.xv,{theme:i.lg.ERROR,title:A("profile error"),text:A("profile error text"),align:i.PH.CENTER})}):(0,C.jsxs)(y.g,{gap:"16",max:!0,className:(0,d.A)(E.ProfileCard,T,[a]),children:[r?.avatar&&(0,C.jsx)(y.U,{justify:"center",className:E.avatarWrapper,children:(0,C.jsx)(v.q,{src:r.avatar})}),(0,C.jsx)(f.I,{value:r?.first,placeholder:A("input firstname"),readonly:o,onChange:s}),(0,C.jsx)(f.I,{className:E.input,value:r?.lastname,placeholder:A("input lastname"),readonly:o,onChange:c}),(0,C.jsx)(f.I,{className:E.input,value:r?.age,placeholder:A("input age"),readonly:o,onChange:u}),(0,C.jsx)(f.I,{className:E.input,value:r?.city,placeholder:A("input city"),readonly:o,onChange:p}),(0,C.jsx)(f.I,{className:E.input,value:r?.username,placeholder:A("input username"),readonly:o,onChange:g}),(0,C.jsx)(f.I,{className:E.input,value:r?.avatar,placeholder:A("input avatar"),readonly:o,onChange:m}),(0,C.jsx)(h,{className:E.input,value:r?.country,readonly:o,onChange:N,direction:"top right"}),(0,C.jsx)(R,{className:E.input,value:r?.currency,readonly:o,onChange:j,direction:"top right"})]})};var j=r(9169),A=r(9728),T=r(8205),U=r(4268);const k=(0,U.hg)("profile/fetchProfileData",(async(e,a)=>{const{extra:r,rejectWithValue:n}=a;try{const a=await r.api.get(`/profile/${e}`);if(!a.data)throw new Error;return a.data}catch(e){return console.log(e),n("error")}})),O=e=>e.profile?.error,_=e=>e.profile?.form,I=e=>e.profile?.isLoading,b=e=>e.profile?.readonly,D=e=>e.profile?.validateErrors,L=(0,U.hg)("profile/updateProfileData",(async(e,a)=>{const{extra:r,rejectWithValue:n,getState:t}=a,o=_(t()),s=(e=>{if(!e)return[l.NO_DATA];const{first:a,lastname:r,age:n,city:t}=e,o=[];return a&&r||o.push(l.INCORRECT_USER_DATA),(!n||n<18||n>100)&&o.push(l.INCORRECT_AGE),t||o.push(l.INCORRECT_CITY),o})(o);if(s.length)return n(s);try{const e=await r.api.put(`/profile/${o?.id}`,o);if(!e.data)throw new Error;return e.data}catch(e){return console.log(e),n([l.SERVER_ERROR])}})),P=(0,U.oM)({name:"profile",initialState:{data:void 0,isLoading:!1,readonly:!0,error:void 0},reducers:{setReadonly:(e,a)=>{e.readonly=a.payload},cancelEdit:e=>{e.readonly=!0,e.form=e.data,e.validateErrors=void 0},updateProfile:(e,a)=>{e.form={...e.form,...a.payload}}},extraReducers:e=>{e.addCase(k.pending,(e=>{e.error=void 0,e.isLoading=!0})).addCase(k.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload})).addCase(k.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload})).addCase(L.pending,(e=>{e.validateErrors=void 0,e.isLoading=!0})).addCase(L.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(L.rejected,((e,a)=>{e.isLoading=!1,e.validateErrors=a.payload}))}}),{actions:S}=P,{reducer:w}=P;var G=r(5321),W=r(4156);const B=e=>e.profile?.data,$=e=>{let{className:a}=e;const{t:r}=(0,n.$G)("profile"),t=(0,s.v9)(B),l=(0,s.v9)(G.m5),c=t?.id===l?.id,d=(0,s.v9)(b),u=(0,j.T)(),p=(0,o.useCallback)((()=>{u(S.setReadonly(!1))}),[u]),h=(0,o.useCallback)((()=>{u(S.cancelEdit())}),[u]),g=(0,o.useCallback)((()=>{u(L())}),[u]);return(0,C.jsxs)(y.U,{justify:"between",max:!0,children:[(0,C.jsx)(i.xv,{title:r("profile page")}),c&&(0,C.jsx)(y.U,{children:d?(0,C.jsx)(W.zx,{theme:W.Wu.OUTLINE,onClick:p,children:r("edit")}):(0,C.jsxs)(y.U,{gap:"8",children:[(0,C.jsx)(W.zx,{theme:W.Wu.OUTLINE,onClick:g,children:r("Save")}),(0,C.jsx)(W.zx,{theme:W.Wu.OUTLINE_RED,onClick:h,children:r("Cancel")})]})})]})},z={profile:w},V=(0,o.memo)((e=>{const{className:a,id:r}=e,{t}=(0,n.$G)("profile"),c=(0,j.T)(),u=(0,s.v9)(_),p=(0,s.v9)(I),h=(0,s.v9)(O),g=(0,s.v9)(b),m=(0,s.v9)(D);(0,A.Q)((()=>{r&&c(k(r))}));const R={[l.INCORRECT_AGE]:t("incorrect age"),[l.INCORRECT_CITY]:t("incorrect  city"),[l.INCORRECT_USER_DATA]:t("incorrect user data"),[l.NO_DATA]:t("incorrect data"),[l.SERVER_ERROR]:t("incorrect server error")},v=(0,o.useCallback)((e=>{c(S.updateProfile({first:e||""}))}),[c]),f=(0,o.useCallback)((e=>{c(S.updateProfile({lastname:e||""}))}),[c]),x=(0,o.useCallback)((e=>{c(S.updateProfile({age:Number(e?.replace(/\D/gi,"")||0)}))}),[c]),E=(0,o.useCallback)((e=>{c(S.updateProfile({city:e||""}))}),[c]),U=(0,o.useCallback)((e=>{c(S.updateProfile({username:e||""}))}),[c]),L=(0,o.useCallback)((e=>{c(S.updateProfile({avatar:e||""}))}),[c]),P=(0,o.useCallback)((e=>{c(S.updateProfile({currency:e}))}),[c]),w=(0,o.useCallback)((e=>{c(S.updateProfile({country:e}))}),[c]);return(0,C.jsx)(T.W,{reducers:z,children:(0,C.jsxs)(y.g,{gap:"16",max:!0,className:(0,d.A)("",{},[a]),children:[(0,C.jsx)($,{}),m?.length&&m.map((e=>(0,C.jsx)(i.xv,{theme:i.lg.ERROR,text:R[e]},e))),(0,C.jsx)(N,{data:u,isLoading:p,error:h,readonly:g,onChangeFirst:v,onChangeLastname:f,onChangeAge:x,onChangeCity:E,onChangeUsername:U,onChangeAvatar:L,onChangeCurrency:P,onChangeCountry:w})]})})}));var F=r(3468);const K=e=>{let{className:a}=e;const{t:r}=(0,n.$G)("profile"),{id:l}=(0,t.UO)();return l?(0,C.jsx)(F.T,{className:(0,d.A)("",{},[a]),children:(0,C.jsx)(y.g,{gap:"16",children:(0,C.jsx)(V,{id:l})})}):(0,C.jsx)(i.xv,{text:r("profile not found")})}}}]);