"use strict";(self.webpackChunkreact_middle=self.webpackChunkreact_middle||[]).push([[891],{3891:(e,a,t)=>{t.r(a),t.d(a,{default:()=>q});var r=t(7294),s=t(9887),l=t(9711),c=t(4187),i=t(8205),o=t(9169),n=t(9728),d=t(3468),g=t(4268),h=t(3879);const u=e=>e.ArticlesPage?.isLoading||!1,p=e=>e.ArticlesPage?.error,m=e=>e.ArticlesPage?.view||h.GA.TILE,v=e=>e.ArticlesPage?.page||1,y=e=>e.ArticlesPage?.order??"asc",A=e=>e.ArticlesPage?.sort??h.$B.CREATED,x=e=>e.ArticlesPage?.search??"",P=e=>e.ArticlesPage?.type??h.Iq.ALL;var S=t(1283);const w=(0,g.hg)("articlesPage/fetchArticlesList",(async(e,a)=>{const{extra:t,rejectWithValue:r,getState:s}=a,l=s().ArticlesPage?.limit||15,c=A(s()),i=y(s()),o=x(s()),n=v(s()),d=P(s());try{g={sort:c,order:i,search:o,type:d},window.history.pushState(null,"",function(e){const a=new URLSearchParams(window.location.search);return Object.entries(e).forEach((e=>{let[t,r]=e;void 0!==r&&a.set(t,r)})),`?${a.toString()}`}(g));const e=await t.api.get("/articles",{params:{_expand:"user",_limit:l,_page:n,_sort:c,_order:i,q:o,type_like:d===h.Iq.ALL?void 0:d}});if(!e.data)throw new Error;return e.data}catch(e){return r("error")}var g})),C=(0,g.HF)({selectId:e=>e.id}),f=C.getSelectors((e=>e.ArticlesPage||C.getInitialState())),j=(0,g.oM)({name:"articlesPageSlice",initialState:C.getInitialState({error:void 0,isLoading:!1,ids:[],entities:{},view:h.GA.TILE,hasMore:!0,page:1,limit:15,_inited:!1,order:"asc",search:"",sort:h.$B.CREATED,type:h.Iq.ALL}),reducers:{setView:(e,a)=>{e.view=a.payload,localStorage.setItem(S.f,a.payload)},setPage:(e,a)=>{e.page=a.payload},initState:e=>{const a=localStorage.getItem(S.f);e.view=a,e.limit=a===h.GA.LIST?4:15,e._inited=!0},setOrder:(e,a)=>{e.order=a.payload},setSort:(e,a)=>{e.sort=a.payload},setSearch:(e,a)=>{e.search=a.payload},setType:(e,a)=>{e.type=a.payload}},extraReducers:e=>{e.addCase(w.pending,((e,a)=>{e.error=void 0,e.isLoading=!0,a.meta.arg.replace&&C.removeAll(e)})).addCase(w.fulfilled,((e,a)=>{e.isLoading=!1,e.hasMore=a.payload.length>=e.limit,a.meta.arg.replace?C.setAll(e,a.payload):C.addMany(e,a.payload)})).addCase(w.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload}))}}),{actions:L,reducer:T}=j,k=(0,g.hg)("articlesPage/fetchNextArticlesPage",(async(e,a)=>{const{getState:t,dispatch:r}=a,s=t().ArticlesPage?.hasMore,l=v(t()),c=u(t());s&&!c&&(r(L.setPage(l+1)),r(w({})))})),b=(0,g.hg)("articlesPage/initArticlesPage",(async(e,a)=>{const{getState:t,dispatch:r}=a;if(!t().ArticlesPage?._inited){const a=e.get("order"),t=e.get("sort"),s=e.get("search"),l=e.get("type");a&&r(L.setOrder(a)),t&&r(L.setSort(t)),s&&r(L.setSearch(s)),l&&r(L.setType(l)),r(L.initState()),r(w({}))}}));var I=t(3942),_=t(6425),E=t(8312),N=t(9457),G=t(5893);const O=(0,r.memo)((e=>{const{className:a}=e,{t}=(0,s.$G)("articles"),l=(0,o.T)(),c=(0,I.v9)(m),i=(0,I.v9)(A),n=(0,I.v9)(y),d=(0,I.v9)(x),g=(0,I.v9)(P),u=(0,r.useCallback)((()=>{l(w({replace:!0}))}),[l]),p=function(e,a){const t=(0,r.useRef)();return(0,r.useCallback)((function(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e(...r)}),500)}),[e,500])}(u),v=(0,r.useCallback)((e=>{l(L.setView(e))}),[l]),S=(0,r.useCallback)((e=>{l(L.setSort(e)),l(L.setPage(1)),u()}),[l,u]),C=(0,r.useCallback)((e=>{l(L.setOrder(e)),l(L.setPage(1)),u()}),[l,u]),f=(0,r.useCallback)((e=>{l(L.setSearch(e)),l(L.setPage(1)),p()}),[l,p]),j=(0,r.useCallback)((e=>{l(L.setType(e)),l(L.setPage(1)),u()}),[l,u]);return(0,G.jsxs)(N.g,{gap:"16",max:!0,children:[(0,G.jsxs)(N.U,{gap:"16",justify:"between",max:!0,children:[(0,G.jsx)(h.xT,{order:n,sort:i,onChangeOrder:C,onChangeSort:S}),(0,G.jsx)(h.Vv,{view:c,onViewClick:v})]}),(0,G.jsx)(_.Z,{max:!0,children:(0,G.jsx)(E.I,{onChange:f,value:d,placeholder:t("search")})}),(0,G.jsx)(h.XL,{value:g,onChangeType:j})]})}));var V=t(1715);const $=(0,r.memo)((e=>{const{className:a}=e,{t}=(0,s.$G)("articles"),r=(0,I.v9)(f.selectAll),l=(0,I.v9)(m),c=(0,I.v9)(u);return(0,I.v9)(p)?(0,G.jsx)(V.xv,{text:t("error load article")}):(0,G.jsx)(h.wD,{view:l,isLoading:c,articles:r,className:a})})),M={ArticlesPage:T},R=e=>{const{className:a}=e,{t}=(0,s.$G)("articles"),g=(0,o.T)(),[h]=(0,l.lr)(),u=(0,r.useCallback)((()=>{g(k())}),[g]);return(0,n.Q)((()=>{g(b(h))})),(0,G.jsx)(i.W,{reducers:M,removeAfterUnmount:!1,children:(0,G.jsxs)(d.T,{onScrollEnd:u,className:(0,c.A)("i0h17",{},[a]),children:[t("ArticlesPage header"),(0,G.jsx)(O,{}),(0,G.jsx)($,{})]})})},q=(0,r.memo)(R)},8312:(e,a,t)=>{t.d(a,{I:()=>i});var r=t(7294),s=t(4187);var l=t(9457),c=t(5893);const i=(0,r.memo)((e=>{const{className:a,value:t="",onChange:r,type:i="text",placeholder:o,readonly:n,...d}=e,g={fTN1P:n};return(0,c.jsxs)(l.g,{gap:"4",max:!0,className:(0,s.A)("LuFDU",g,[a]),children:[(0,c.jsx)("div",{children:o}),(0,c.jsx)("input",{type:i,onChange:e=>{r?.(e.target.value)},className:"X8EVb",placeholder:o,value:t,readOnly:n,...d})]})}))}}]);