"use strict";(self.webpackChunkreact_middle=self.webpackChunkreact_middle||[]).push([[891],{11:(e,a,t)=>{t.d(a,{I:()=>i});var r=t(7294),s=t(9457),l=t(4187);var c=t(5893);const i=(0,r.memo)((e=>{const{className:a,value:t="",onChange:r,type:i="text",placeholder:o,readonly:n,...d}=e,g={fTN1P:n};return(0,c.jsxs)(s.g,{gap:"4",max:!0,className:(0,l.A)("LuFDU",g,[a]),children:[(0,c.jsx)("div",{children:o}),(0,c.jsx)("input",{type:i,onChange:e=>{r?.(e.target.value)},className:"X8EVb",placeholder:o,value:t,readOnly:n,...d})]})}))},3891:(e,a,t)=>{t.r(a),t.d(a,{default:()=>q});var r=t(7294),s=t(9887),l=t(9711),c=t(4268),i=t(1397);const o=e=>e.ArticlesPage?.isLoading||!1,n=e=>e.ArticlesPage?.error,d=e=>e.ArticlesPage?.view||i.GA.TILE,g=e=>e.ArticlesPage?.page||1,h=e=>e.ArticlesPage?.order??"asc",u=e=>e.ArticlesPage?.sort??i.$B.CREATED,p=e=>e.ArticlesPage?.search??"",m=e=>e.ArticlesPage?.type??i.Iq.ALL;const v=(0,c.hg)("articlesPage/fetchArticlesList",(async(e,a)=>{const{extra:t,rejectWithValue:r,getState:s}=a,l=s().ArticlesPage?.limit||15,c=u(s()),o=h(s()),n=p(s()),d=g(s()),v=m(s());try{y={sort:c,order:o,search:n,type:v},window.history.pushState(null,"",function(e){const a=new URLSearchParams(window.location.search);return Object.entries(e).forEach((e=>{let[t,r]=e;void 0!==r&&a.set(t,r)})),`?${a.toString()}`}(y));const e=await t.api.get("/articles",{params:{_expand:"user",_limit:l,_page:d,_sort:c,_order:o,q:n,type_like:v===i.Iq.ALL?void 0:v}});if(!e.data)throw new Error;return e.data}catch(e){return r("error")}var y}));var y=t(1283);const A=(0,c.HF)({selectId:e=>e.id}),x=A.getSelectors((e=>e.ArticlesPage||A.getInitialState())),P=(0,c.oM)({name:"articlesPageSlice",initialState:A.getInitialState({error:void 0,isLoading:!1,ids:[],entities:{},view:i.GA.TILE,hasMore:!0,page:1,limit:15,_inited:!1,order:"asc",search:"",sort:i.$B.CREATED,type:i.Iq.ALL}),reducers:{setView:(e,a)=>{e.view=a.payload,localStorage.setItem(y.fK,a.payload)},setPage:(e,a)=>{e.page=a.payload},initState:e=>{const a=localStorage.getItem(y.fK);e.view=a,e.limit=a===i.GA.LIST?4:15,e._inited=!0},setOrder:(e,a)=>{e.order=a.payload},setSort:(e,a)=>{e.sort=a.payload},setSearch:(e,a)=>{e.search=a.payload},setType:(e,a)=>{e.type=a.payload}},extraReducers:e=>{e.addCase(v.pending,((e,a)=>{e.error=void 0,e.isLoading=!0,a.meta.arg.replace&&A.removeAll(e)})).addCase(v.fulfilled,((e,a)=>{e.isLoading=!1,e.hasMore=a.payload.length>=e.limit,a.meta.arg.replace?A.setAll(e,a.payload):A.addMany(e,a.payload)})).addCase(v.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload}))}}),{actions:S,reducer:w}=P,C=(0,c.hg)("articlesPage/fetchNextArticlesPage",(async(e,a)=>{const{getState:t,dispatch:r}=a,s=t().ArticlesPage?.hasMore,l=g(t()),c=o(t());s&&!c&&(r(S.setPage(l+1)),r(v({})))})),f=(0,c.hg)("articlesPage/initArticlesPage",(async(e,a)=>{const{getState:t,dispatch:r}=a;if(!t().ArticlesPage?._inited){const a=e.get("order"),t=e.get("sort"),s=e.get("search"),l=e.get("type");a&&r(S.setOrder(a)),t&&r(S.setSort(t)),s&&r(S.setSearch(s)),l&&r(S.setType(l)),r(S.initState()),r(v({}))}}));var j=t(3942),L=t(8699),T=t(5893);const k=(0,r.memo)((e=>{const{className:a}=e,{t}=(0,s.$G)("articles"),r=(0,j.v9)(x.selectAll),l=(0,j.v9)(d),c=(0,j.v9)(o);return(0,j.v9)(n)?(0,T.jsx)(L.xv,{text:t("error load article")}):(0,T.jsx)(i.wD,{view:l,isLoading:c,articles:r,className:a})}));var b=t(9169),I=t(1554),_=t(11),E=t(9457);const N=(0,r.memo)((e=>{const{className:a}=e,{t}=(0,s.$G)("articles"),l=(0,b.T)(),c=(0,j.v9)(d),o=(0,j.v9)(u),n=(0,j.v9)(h),g=(0,j.v9)(p),y=(0,j.v9)(m),A=(0,r.useCallback)((()=>{l(v({replace:!0}))}),[l]),x=function(e,a){const t=(0,r.useRef)();return(0,r.useCallback)((function(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e(...r)}),500)}),[e,500])}(A),P=(0,r.useCallback)((e=>{l(S.setView(e))}),[l]),w=(0,r.useCallback)((e=>{l(S.setSort(e)),l(S.setPage(1)),A()}),[l,A]),C=(0,r.useCallback)((e=>{l(S.setOrder(e)),l(S.setPage(1)),A()}),[l,A]),f=(0,r.useCallback)((e=>{l(S.setSearch(e)),l(S.setPage(1)),x()}),[l,x]),L=(0,r.useCallback)((e=>{l(S.setType(e)),l(S.setPage(1)),A()}),[l,A]);return(0,T.jsxs)(E.g,{gap:"16",max:!0,children:[(0,T.jsxs)(E.U,{gap:"16",justify:"between",max:!0,children:[(0,T.jsx)(i.xT,{order:n,sort:o,onChangeOrder:C,onChangeSort:w}),(0,T.jsx)(i.Vv,{view:c,onViewClick:P})]}),(0,T.jsx)(I.Z,{max:!0,children:(0,T.jsx)(_.I,{onChange:f,value:g,placeholder:t("search")})}),(0,T.jsx)(i.XL,{value:y,onChangeType:L})]})}));var G=t(4187),O=t(8205),V=t(9728),$=t(3468);const M={ArticlesPage:w},R=e=>{const{className:a}=e,{t}=(0,s.$G)("articles"),c=(0,b.T)(),[i]=(0,l.lr)(),o=(0,r.useCallback)((()=>{c(C())}),[c]);return(0,V.Q)((()=>{c(f(i))})),(0,T.jsx)(O.W,{reducers:M,removeAfterUnmount:!1,children:(0,T.jsxs)($.T,{onScrollEnd:o,className:(0,G.A)("i0h17",{},[a]),children:[t("ArticlesPage header"),(0,T.jsx)(N,{}),(0,T.jsx)(k,{})]})})},q=(0,r.memo)(R)}}]);