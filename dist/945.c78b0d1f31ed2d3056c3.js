"use strict";(self.webpackChunkreact_middle=self.webpackChunkreact_middle||[]).push([[945],{7415:(e,s,a)=>{a.r(s),a.d(s,{default:()=>B});var t=a(7294),r=a(9887),i=a(6974),n=a(2445),l=a(4187),c=a(9457),d=a(1715);const o=a(6628).p.injectEndpoints({endpoints:e=>({getArticleRecommendationsList:e.query({query:e=>({url:"/articles",params:{_limit:e}})})})}).useGetArticleRecommendationsListQuery;var m=a(5893);const x=(0,t.memo)((e=>{const{className:s}=e,{t:a}=(0,r.$G)("articles_details"),{isLoading:t,error:i,data:x}=o(4);return t||i||!x?null:(0,m.jsxs)(c.g,{gap:"8",className:(0,l.A)("",{},[s]),children:[(0,m.jsx)(d.xv,{size:d.yH.L,title:a("Recommended")}),(0,m.jsx)(n.wD,{articles:x,target:"_blank"})]})}));var u=a(7779),h=a(5754),g=a(4268);const j=(0,g.hg)("articleDetails/fetchCommentsByArticleId",(async(e,s)=>{const{extra:a,rejectWithValue:t}=s;if(!e)return t("error");try{const s=await a.api.get("/comments/",{params:{articleId:e,_expand:"user"}});if(!s.data)throw new Error;return s.data}catch(e){return t("error")}})),v=(0,g.HF)({selectId:e=>e.id}),p=v.getSelectors((e=>e.ArticleDetailsPages?.comments||v.getInitialState())),N=(0,g.oM)({name:"articleDetailsComments",initialState:v.getInitialState({error:void 0,isLoading:!1,ids:[],entities:{}}),reducers:{},extraReducers:e=>{e.addCase(j.pending,(e=>{e.error=void 0,e.isLoading=!0})).addCase(j.fulfilled,((e,s)=>{e.isLoading=!1,v.setAll(e,s.payload)})).addCase(j.rejected,((e,s)=>{e.isLoading=!1,e.error=s.payload}))}}),{reducer:C}=N,A=(0,u.UY)({recommendations:h.r,comments:C});var L=a(8205),f=a(4876),w=a(3942),y=a(2222),_=a(5321);const b=(0,y.P1)(n.wq,_.m5,((e,s)=>!(!e||!s)&&e.user.id===s.id));var k=a(9372),D=a(5255);const I=(0,t.memo)((e=>{const{className:s}=e,{t:a}=(0,r.$G)("articles_details"),d=(0,i.s0)(),o=(0,w.v9)(b),x=(0,w.v9)(n.wq),u=(0,t.useCallback)((()=>{d(k.h.articles)}),[d]),h=(0,t.useCallback)((()=>{d(`${k.h.article_details}${x?.id}/edit`)}),[x?.id,d]);return(0,m.jsxs)(c.U,{justify:"between",max:!0,className:(0,l.A)("",{},[s]),children:[(0,m.jsx)(D.zx,{theme:D.Wu.OUTLINE,onClick:u,children:a("back to list")}),o&&(0,m.jsx)(D.zx,{theme:D.Wu.OUTLINE,onClick:h,children:a("Edit")})]})})),$="adu8f",S=(0,t.lazy)((()=>a.e(62).then(a.bind(a,2062))));var z=a(3312),q=a(2949),E=a(6897);const G={CommentCard:"D_1ld",header:"MKn3Z",username:"hXMDF",loading:"SrYg_"},O=(0,t.memo)((e=>{const{className:s,comments:a,isLoading:t}=e;return t?(0,m.jsxs)("div",{className:(0,l.A)(G.CommentCard,{},[s,G.loading]),children:[(0,m.jsxs)("div",{className:G.header,children:[(0,m.jsx)(z.O,{width:30,height:30,border:"50%",className:G.avatar}),(0,m.jsx)(z.O,{height:16,width:100})]}),(0,m.jsx)(z.O,{className:G.text,width:"100%",height:50})]}):a?(0,m.jsxs)(c.g,{gap:"8",max:!0,className:(0,l.A)(G.CommentCard,{},[s]),children:[(0,m.jsxs)(E.F,{to:`${k.h.profile}${a.user.id}`,className:G.header,children:[a.user.avatar?(0,m.jsx)(q.q,{size:30,src:a.user.avatar,className:G.avatar}):null,(0,m.jsx)(d.xv,{title:a.user.username})]}),(0,m.jsx)(d.xv,{className:G.text,text:a.text})]}):null})),U=(0,t.memo)((e=>{const{className:s,isLoading:a,comments:t}=e,{t:i}=(0,r.$G)("articles_details");return a?(0,m.jsxs)(c.g,{gap:"16",max:!0,className:(0,l.A)("",{},[s]),children:[(0,m.jsx)(O,{isLoading:!0}),(0,m.jsx)(O,{isLoading:!0}),(0,m.jsx)(O,{isLoading:!0})]}):(0,m.jsx)(c.g,{gap:"16",max:!0,className:(0,l.A)("",{},[s]),children:t?.length?t.map((e=>(0,m.jsx)(O,{isLoading:a,comments:e},e.id))):(0,m.jsx)(d.xv,{text:i("no comments")})})}));var T=a(9169),W=a(9728),F=a(3212);const P=e=>e.ArticleDetailsPages?.comments.isLoading||!1;var R=a(3860);const H=(0,g.hg)("articleDetails/addCommentForArticle",(async(e,s)=>{const{extra:a,rejectWithValue:t,getState:r,dispatch:i}=s,n=(0,_.m5)(r()),l=(0,R.wq)(r());if(!e||!n||!l)return t("no data");try{const s=await a.api.post("/comments",{articleId:l.id,text:e,userId:n.id});if(!s.data)throw new Error("No data");return i(j(l.id)),s.data}catch(e){return console.log(e),t("error")}})),M=(0,t.memo)((e=>{const{className:s,id:a}=e,{t:i}=(0,r.$G)("articles_details"),n=(0,T.T)(),o=(0,w.v9)(P),x=(0,w.v9)(p.selectAll);(0,W.Q)((()=>{n(j(a))}));const u=(0,t.useCallback)((e=>{n(H(e))}),[n]);return(0,m.jsxs)(c.g,{gap:"16",max:!0,className:(0,l.A)("",{},[s]),children:[(0,m.jsx)(d.xv,{size:d.yH.L,title:i("Comment title")}),(0,m.jsx)(t.Suspense,{fallback:(0,m.jsx)(F.a,{}),children:(0,m.jsx)(S,{onSendComment:u})}),(0,m.jsx)(U,{comments:x,isLoading:o})]})})),Q=(0,t.lazy)((()=>a.e(798).then(a.bind(a,7798)))),V={ArticleDetailsPages:A},Y=e=>{const{className:s}=e,{t:a}=(0,r.$G)("articles_details"),{id:t}=(0,i.UO)();return t?(0,m.jsx)(L.W,{reducers:V,removeAfterUnmount:!0,children:(0,m.jsx)(f.T,{className:(0,l.A)($,{},[s]),children:(0,m.jsxs)(c.g,{gap:"16",max:!0,children:[(0,m.jsx)(I,{}),(0,m.jsx)(n.D0,{id:t}),(0,m.jsx)(Q,{articleId:t}),(0,m.jsx)(x,{}),(0,m.jsx)(M,{id:t})]})})}):(0,m.jsx)(f.T,{className:(0,l.A)($,{},[s]),children:a("articles not found")})},B=(0,t.memo)(Y)}}]);